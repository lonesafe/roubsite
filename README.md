# RoubSite
**å¦‚æœä½ å–œæ¬¢è¿™ä¸ªé¡¹ç›®ï¼Œè¯·ç»™å®ƒä¸€ä¸ªstar**  
[![GitHub license](https://img.shields.io/github/license/lonesafe/roubsite?style=flat-square)](https://github.com/lonesafe/roubsite/blob/master/LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/lonesafe/roubsite?style=flat-square)](https://github.com/lonesafe/roubsite/stargazers)
[![Javadocs](http://www.javadoc.io/badge/com.roubsite/RoubSiteFramework.svg)](https://www.javadoc.io/doc/com.roubsite/RoubSiteFramework)
[![Maven Central](https://maven-badges.herokuapp.com/maven-central/com.roubsite/RoubSite/badge.svg?style=blue)](https://maven-badges.herokuapp.com/maven-central/com.roubsite/RoubSite)
[![Build Status](https://www.travis-ci.org/lonesafe/roubsite.svg?branch=master)](https://www.travis-ci.org/lonesafe/roubsite)
[![æ°´æ™¶è§ç«¹/RoubSite](https://gitee.com/lonesafe/RoubSite/widgets/widget_card.svg?colors=4183c4,ffffff,ffffff,e3e9ed,666666,9b9b9b)](https://gitee.com/lonesafe/RoubSite)

## ä»‹ç»
RoubSiteæ˜¯ä¸€ä¸ªç®€å•ã€è½»é‡ã€æ˜“ä¸Šæ‰‹çš„java webå¼€å‘æ¡†æ¶ï¼Œé¡¹ç›®ç ”å‘çš„åˆè¡·æ˜¯å†™ä¸€ä¸ªå¯ä»¥è®©åˆšå…¥è¡Œçš„ç¨‹åºçŒ¿å¿«é€ŸæŒæ¡java webå¼€å‘çš„è¿™ä¹ˆä¸€ä¸ªæ¡†æ¶ã€‚  
ğŸ‰ğŸ‰ğŸ‰RoubSiteAdminæ˜¯åŸºäºRoubSiteå¼€å‘çš„ä¸€å¥—åå°æƒé™ç®¡ç†æ¡†æ¶ï¼Œç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€èœå•ä¸€æ•´å¥—éƒ½å†™å¥½äº†ï¼Œç»“åˆä»£ç ç”Ÿæˆæœºï¼Œç®€å•å¢åˆ æ”¹æŸ¥ï¼Œé€šè¿‡é…ç½®å°±å¯ä»¥æå®šã€‚  
[å®˜ç½‘https://www.roubsite.com](https://www.roubsite.com)
## RoubSiteAdminæ¼”ç¤ºåœ°å€
[ğŸ”¥ğŸ”¥RoubSiteAdminåå°ç®¡ç†æ¡†æ¶](https://test.roubsite.com)  
è´¦å·ï¼šadmin   å¯†ç ï¼šadmin  
ä¸è¦ä¿®æ”¹å¯†ç ï¼Œæµ‹è¯•ç”¨æˆ·åŠŸèƒ½å¯ä»¥æ–°å»ºç”¨æˆ·ï¼Œadminç”¨æˆ·ä¸è¦ä¿®æ”¹å¯†ç ï¼ï¼
## RoubSiteæ¡†æ¶ä½¿ç”¨Demo
[ğŸ‰ğŸ‰ğŸ‰RoubSiteæ¡†æ¶Demoï¼šhttps://gitee.com/lonesafe/roubsite-demo](https://gitee.com/lonesafe/roubsite-demo)  
## è½¯ä»¶æ¶æ„
æ•´ä¸ªæ¡†æ¶åˆ†ä¸ºActionï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰ã€Daoï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰ã€Beanï¼ˆå®ä½“ç±»ï¼‰è¿™ä¸‰å±‚ï¼›  
é¡µé¢æ¨¡æ¿å®ç°äº†ç±»ä¼¼PHPä¸­çš„smartyæ¡†æ¶çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä½¿ç”¨èµ·æ¥ååˆ†æ–¹ä¾¿ã€‚
## å¿«é€Ÿå¼€å§‹
### æ·»åŠ mavenä¾èµ–
Smartyæ˜¯æ¡†æ¶çš„ä¾èµ–é¡¹ï¼Œä¼šè‡ªåŠ¨å¼•å…¥ã€‚  
å¼•å…¥æ¡†æ¶ï¼ˆå¿…é¡»ï¼‰ï¼š
```xml
<dependency>
  <groupId>com.roubsite</groupId>
  <artifactId>RoubSiteFramework</artifactId>
  <version>4.0.0</version>
  <type>jar</type>
</dependency>
```
å¼•å…¥æƒé™ç®¡ç†ï¼ˆå¯é€‰ï¼‰ï¼š
```xml
<dependency>
  <groupId>com.roubsite</groupId>
  <artifactId>RoubSiteSecurity</artifactId>
  <version>4.0.0</version>
  <type>jar</type>
</dependency>
```
å¼•å…¥ä»£ç ç”Ÿæˆæœºï¼ˆå¯é€‰ï¼‰ï¼š
```xml
<dependency>
  <groupId>com.roubsite</groupId>
  <artifactId>RoubSiteCodeSign</artifactId>
  <version>4.0.0</version>
  <type>jar</type>
</dependency>
```
### é…ç½®web.xml
```xml
<!-- log4jé…ç½® -->
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>classpath:log4j.properties</param-value>
</context-param>
<!-- å¼•å…¥RoubSiteæ¡†æ¶ç›‘å¬å™¨ -->
<listener>
    <listener-class>com.roubsite.web.listener.RSConfigListenerContext</listener-class>
</listener>
```
### é…ç½®æ–‡ä»¶(V4.0.0åŠä»¥ä¸Šç‰ˆæœ¬æ¨èä½¿ç”¨YMLæ–¹å¼)
**å¼ºçƒˆæ¨èä½¿ç”¨æ­¤æ–¹å¼ï¼**
é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨resourcesä¸­ï¼Œåå­—å¯ä»¥éšä¾¿èµ·ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨æ‰«ææ‰€æœ‰çš„é…ç½®æ–‡ä»¶ã€‚
```yaml
RoubSite:
  #ä»£ç ç”Ÿæˆæœºé…ç½®
  codeSign:
    #ä»£ç è¾“å‡ºè·¯å¾„
    outputPath: d:/demo
  #æ˜¯å¦å¼€å¯é˜²æ³¨å…¥æ‹¦æˆªå™¨
  injection: true
  global:
    #é»˜è®¤åˆ†ç»„
    defaultGroup: admin
    #åˆ†ç»„
    group:
      #åˆ†ç»„ï¼šå¯¹åº”çš„åŒ…
      codeSign: com.roubsite.code
      index: com.roubsite.site
      admin: com.roubsite.admin
      sso: com.roubsite.sso
    #é™æ€èµ„æºåç¼€
    static_suffix: "*.jpg,*.css,*.png,*.js,*.gif,*.swf,*.ico,*.rar,*.woff,*.ttf,*.eot"
    #é”™è¯¯é¡µæ–‡ä»¶è·¯å¾„
    errorPage:
    #æˆåŠŸé¡µæ–‡ä»¶è·¯å¾„
    successPage:
  #æƒé™ç®¡ç†æ¡†æ¶é…ç½®
  security:
    #æ¡†æ¶æ‹¦æˆªå™¨
    class: "com.roubsite.security.filter.SecurityFilter"
    #ä¸è¿›è¡Œæ‹¦æˆªçš„èµ„æº
    missing: "*.jpg,*.css,*.png,*.js,*.gif,*.swf,*.ico,*.rar,*.woff,*.ttf,*.eot"
    #ç™»é™†åœ°å€
    loginUrl: "/admin/login"
  #æ¨¡æ¿è®¾ç½®
  smarty:
    #è°ƒè¯•æ¨¡å¼
    debug: true
    #å¯ç”¨cacheï¼Œå¦‚æœé‡åˆ°å˜é‡æ— æ³•åˆ·æ–°çš„é—®é¢˜ï¼Œè¯·å…³é—­ç¼“å­˜(cache=off)
    cache: off
    #æ¨¡æ¿æ–‡ä»¶ç¼–ç é›†
    encoding: UTF-8
    #å·¦è¾¹ç•Œå®šç•Œç¬¦
    left.delimiter: "{"
    #å³è¾¹ç•Œå®šç•Œç¬¦
    right.delimiter: "}"
    #å‡½æ•°æ‰©å±•åŒ…çš„åç§°ï¼Œä»¥:åˆ†éš”
    package:
      function: com.roubsite.smarty4j.statement.function
      #å˜é‡è°ƒèŠ‚å™¨æ‰©å±•åŒ…çš„åç§°ï¼Œä»¥:åˆ†éš”
      modifier: com.roubsite.smarty4j.statement.modifier

  #æ•°æ®æºé…ç½®
  DataSourcePool:
    #æ˜¯å¦å¼€å¯druidæ§åˆ¶å°
    console: true
    #é»˜è®¤æ•°æ®æº
    default: dataSource
    #æ•°æ®æºåˆ—è¡¨
    dataSources:
      #æ•°æ®æºDataSource
      dataSource:
        #æ•°æ®æºç±»å‹ï¼ˆ1ï¼šmysqlï¼Œ2ï¼šoracleï¼‰ç”¨äºä»£ç ç”Ÿæˆä½¿ç”¨
        type: 1
        driverClassName: com.mysql.jdbc.Driver
        url: "jdbc:mysql://127.0.0.1:3306/roubsite_dev?useUnicode=true&characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull&autoReconnect=true"
        username: root
        password: root
        #æ•°æ®åº“æ± å¤§å°
        poolSize: 12
        #æ˜¯å¦ä¿æŒè¿æ¥
        keepAlive: true
        #æœ€å¤§ç­‰å¾…æ—¶é—´
        maxWaitMillis: 100000
        #æœ€å¤§çº¿ç¨‹ç­‰å¾…æ—¶é—´
        maxWaithThreadCount: 12
      #æ•°æ®æºDataSource2
#      dataSource2:
#        type: 2
#        driverClassName: com.mysql.jdbc.Driver
#        url=jdbc: mysql://127.0.0.1:3306/ls_srr?useUnicode=true&characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull
#        username: root
#        password: root
#        poolSize: 12
```

#### log4j2.yml(å¯é€‰ï¼Œæ²¡æœ‰è¯¥é…ç½®å½±å“log4jæ‰“å°æ—¥å¿—)
```yaml
Configuration:
   status: DEBUG
   Properties: # å®šä¹‰å…¨å±€å˜é‡  
      Property:
      -  name: log.path
         value: D:/RoubSite-log
   Loggers:
      Root:
         level: DEBUG
         AppenderRef:
         -  ref: CONSOLE
         -  ref: ROOT_LOG
      Logger:
      -  name: com.roubsite.web
         additivity: true
         level: DEBUG
         AppenderRef:
         -  ref: ROUBSITE_FRAMEWORK
      -  name: com.roubsite.database
         additivity: true
         level: DEBUG
         AppenderRef:
         -  ref: ROUBSITE_DATABASE
      -  name: com.roubsite.security
         additivity: true
         level: DEBUG
         AppenderRef:
         -  ref: ROUBSITE_SECURITY
      -  name: org.activiti
         additivity: true
         level: DEBUG
         AppenderRef:
         -  ref: ROUBSITE_ACTIVITI
   Appenders:
      Console: #è¾“å‡ºåˆ°æ§åˆ¶å°  
         name: CONSOLE
         target: SYSTEM_OUT
         follow: true
         PatternLayout:
            pattern: '%n%m%n'
      RollingFile: # è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œè¶…è¿‡128MBå½’æ¡£  
      -  name: ROOT_LOG
         ignoreExceptions: false
         fileName: ${log.path}/root.log
         filePattern: ${log.path}/%d{yyyy-MM-dd}-%i-root.log.gz
         PatternLayout:
            pattern: '[%-5p][%-22d{yyyy/MM/dd HH:mm:ssS}][%l]%n%m%n '
         Policies:
            SizeBasedTriggeringPolicy:
               size: 128 MB
         DefaultRolloverStrategy:
            max: 1000
      -  name: ROUBSITE_FRAMEWORK
         ignoreExceptions: false
         fileName: ${log.path}/roubsite_framework.log
         filePattern: ${log.path}/%d{yyyy-MM-dd}-%i-roubsite_framework.log.gz
         PatternLayout:
            pattern: '[%-5p][%-22d{yyyy/MM/dd HH:mm:ssS}][%l]%n%m%n '
         Policies:
            SizeBasedTriggeringPolicy:
               size: 128 MB
         DefaultRolloverStrategy:
            max: 1000
      -  name: ROUBSITE_SECURITY
         ignoreExceptions: false
         fileName: ${log.path}/roubsite_security.log
         filePattern: ${log.path}/%d{yyyy-MM-dd}-%i-roubsite_security.log.gz
         PatternLayout:
            pattern: '[%-5p][%-22d{yyyy/MM/dd HH:mm:ssS}][%l]%n%m%n '
         Policies:
            SizeBasedTriggeringPolicy:
               size: 128 MB
         DefaultRolloverStrategy:
            max: 1000
      -  name: ROUBSITE_DATABASE
         ignoreExceptions: false
         fileName: ${log.path}/roubsite_database.log
         filePattern: ${log.path}/%d{yyyy-MM-dd}-%i-roubsite_database.log.gz
         PatternLayout:
            pattern: '[%-5p][%-22d{yyyy/MM/dd HH:mm:ssS}][%l]%n%m%n '
         Policies:
            SizeBasedTriggeringPolicy:
               size: 128 MB
         DefaultRolloverStrategy:
            max: 1000
      -  name: ROUBSITE_ACTIVITI
         ignoreExceptions: false
         fileName: ${log.path}/roubsite_activiti.log
         filePattern: ${log.path}/%d{yyyy-MM-dd}-%i-roubsite_activiti.log.gz
         PatternLayout:
            pattern: '[%-5p][%-22d{yyyy/MM/dd HH:mm:ssS}][%l]%n%m%n '
         Policies:
            SizeBasedTriggeringPolicy:
               size: 128 MB
         DefaultRolloverStrategy:
            max: 1000 
```

### hello world
å¤åˆ¶ä¸Šé¢çš„é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ¨¡å—â€œindexâ€ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æˆ‘ä»¬çŸ¥é“â€œindexâ€å¯¹åº”çš„åŒ…å
æ˜¯â€œcom.roubsite.siteâ€ï¼Œæ ¹æ®è¿™ä¸ªåŒ…åæˆ‘ä»¬æ–°å»ºä¸‰ä¸ªåŒ…â€œcom.roubsite.site.actionâ€ã€â€œcom.roubsite.site.beanâ€ã€â€œcom.roubsite.site.daoâ€ï¼Œ
è¿™ä¸‰ä¸ªåŒ…ååˆ†åˆ«å¯¹åº”â€œæ§åˆ¶å™¨â€ã€â€œæ•°æ®åº“å®ä½“â€ã€â€œæ•°æ®åº“æ“ä½œâ€ã€‚
æˆ‘ä»¬åœ¨â€œcom.roubsite.site.actionâ€ä¸‹åˆ›å»ºä¸€ä¸ªç»§æ‰¿â€œRSActionâ€çš„å¾—ç±»â€œIndexActionâ€ï¼Œå¹¶ä¸”å®ç°â€œexecuteâ€æ–¹æ³•ï¼š  
![img.png](img.png)  
ç„¶ååœ¨â€œsrc/webapp/templates/indexâ€ä¸‹é¢å†æ·»åŠ ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶â€œindex.htmlâ€ï¼š  
![img_1.png](img_1.png)  
ç„¶åå¯åŠ¨tomcatè®¿é—®å³å¯çœ‹åˆ°æ•ˆæœï¼ˆ**_å…·ä½“æ§åˆ¶å™¨å’Œæ¨¡æ¿çš„å¯¹åº”å…³ç³»ã€urlå’Œæ§åˆ¶å™¨çš„å¯¹åº”å…³ç³»å¯ä»¥æŸ¥çœ‹æ“ä½œæ‰‹å†Œ_**ï¼‰

## RoubSiteéƒ½åŒ…å«é‚£äº›æ¨¡å—

1.  RoubSiteFramework RoubSiteæ¡†æ¶ï¼ŒActionã€Daoçš„ä»£ç å®ç°éƒ½åœ¨é‡Œé¢ã€‚
2.  RoubSiteSecurity æƒé™ç®¡ç†ï¼Œåœ¨Actionä¸­ä½¿ç”¨æ³¨è§£æ–¹å¼å¯¹æ–¹æ³•è¿›è¡Œæƒé™æ§åˆ¶ï¼Œè‡ªå·±å†™æƒé™ç®¡ç†å¯ä»¥ä¸ç”¨å®ƒã€‚
3.  RoubSiteSmarty4j æ¨¡æ¿è§£é‡Šå™¨ï¼Œå‚è€ƒäº†githubä¸Šçš„ä»£ç ï¼ŒåŸä½œè€…å®åœ¨æ˜¯æ²¡æ‰¾åˆ°ã€‚
4.  RoubSiteCodeSign ä»£ç ç”Ÿæˆæœºï¼Œè¿™å¯æ˜¯ä¸€ä¸ªé‡å¤´æˆï¼Œå®ƒå¯ä»¥ç›´æ¥å°†æ•°æ®åº“çš„è¡¨ç”Ÿæˆå¯¹åº”çš„å¢åˆ æ”¹æŸ¥çš„ä»£ç ï¼Œé¡µé¢ä¹ŸåŒæ—¶ç”Ÿæˆï¼Œå‡å°‘å·¥ä½œé‡çš„é¦–é€‰ã€‚ï¼ˆå¯ä»¥é€šè¿‡https://gitee.com/lonesafe/roub-site-admin é¡¹ç›®ä½¿ç”¨ï¼‰
